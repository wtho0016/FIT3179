{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",

      "title": "Top 20 Countries by Tourism Employment (Millions)",
      "width": 450,
      "background": "transparent",
      "height": 450,
      "padding": {"bottom": 20},
      "config": {
      "view": {"stroke": "transparent", "fill": "transparent"},
      "padding": {"left": 150}},
      "params": [
          {
          "name": "year_selection",
          "value": 2023,
          "bind": {
            "input": "range",
            "min": 2008,
            "max": 2023,
            "step": 1,
            "name": "Year:  "
            }
          }
        ],
      "data": { "url": "https://raw.githubusercontent.com/wtho0016/FIT3179/main/DV2/Data/UN_Tourism_8_9_2_employed_persons_04_2025.csv" },
      "transform": [
        { "calculate": "toNumber(trim(datum.Value))", "as": "Value_num" },
        { "calculate": "format(datum.Value / 1000000, '.2f') ", "as": "tooltip_text"},
        { "filter": "datum.TimePeriod == year_selection" },
        { "window": [{"op": "rank", "as": "rank"}], "sort": [{"field": "Value_num", "order": "descending"}]},
        { "filter": "datum.rank <= 20" }
      ],
          "mark": "bar",
          "encoding": 
          {
            "x": 
            { 
              "field": "Value", 
              "type": "quantitative", 
              "title": "Employment (Millions of People)"
            },
            "y": 
            { 
              "field": "GeoAreaName", 
              "type": "nominal", 
              "title": "Country",
              "sort": {"field": "Value_num", "order": "descending"
            }
            },
            "tooltip": 
            [
              {"field": "GeoAreaName", "type": "nominal", "title": "Country"},
              {"field": "tooltip_text", "type": "quantitative", "title": "Total Employed (millions)"}
            ]
          }
}