{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "description": "Bubble chart: Compare countries by occupancy rate vs average length of stay. Size = number of rooms, filter by year.",
    "data": {
        "url": "https://raw.githubusercontent.com/wtho0016/FIT3179/refs/heads/main/DV2/Data/accommodation.csv"
    },
    "width": 450,
    "background": "transparent",
    "height": 450,
    "padding": {"bottom": 20},
    "config": {
        "title": {"font": "Oxygen", "fontSize": 18},"axis": {
        "labelFont": "Oxygen",
        "titleFont": "Oxygen",
        "labelFontSize": 12,
        "titleFontSize": 14
      },
      "legend": {
        "labelFont": "Oxygen",
        "titleFont": "Oxygen",
        "labelFontSize": 12,
        "titleFontSize": 12
      },
      "text": {
        "font": "Oxygen",
        "fontSize": 12
      },
    "view": {"stroke": "transparent", "fill": "transparent"},
    "padding": {"left": 150}},
    "params": [
        {
        "name": "year_chosen",
        "value": 2022,
        "bind": {
                "input": "range",
                "min": 2008,
                "max": 2022,
                "step": 1,
                "name": "Select Year: "
        }
        }
    ],
  "transform": [
    {"filter": "isValid(datum['Average length of stay']) && isValid(datum['Occupancy rate / rooms']) && isValid(datum['Number of rooms']) && datum['Average length of stay'] > 0 && datum['Occupancy rate / rooms'] > 0 && datum['Number of rooms'] > 0"},
    {"filter": "datum.Year == year_chosen"}
  ],
  "mark": {
    "type": "circle",
    "opacity": 0.7,
    "stroke": "black",
    "strokeWidth": 0.5
  },
  "encoding": {
    "x": {
      "field": "Occupancy rate / rooms",
      "type": "quantitative",
      "title": "Occupancy Rate (Rooms, %)"
    },
    "y": {
      "field": "Average length of stay",
      "type": "quantitative",
      "title": "Average Length of Stay (Nights)"
    },
    "size": {
      "field": "Number of rooms",
      "type": "quantitative",
      "title": "Number of Rooms",
      "scale": {"range": [100,2000]}
    },
    "color": {"value": "#1f77b4"},
    "tooltip": [
      {"field": "Country","type":"nominal"},
      {"field": "Year","type":"ordinal"},
      {"field": "Occupancy rate / rooms","type":"quantitative"},
      {"field": "Average length of stay","type":"quantitative"},
      {"field": "Number of rooms","type":"quantitative"}
    ]
  }
}
